Notifications alert users to information or a request so that they can act on it.  They are generated by the workflow and will appear on the notifications page for the user receiving them.  Users will also receive notifications by email unless they turn this feature off.  This is managed from the settings page.

Notifications may be configured either at the process level or at the step level.  Process level notifications will trigger whenever a step in that process meets the relevant conditions are met.  Step level notifications only trigger when the relevant conditions are met for the specific step they are configured on.

**There are two basic types of notifications**

1. Implicit (Assignment/acceptance/ReAssignment) which goes automatically to the user and users list is pre-calculated by the system. In case of assignment, notification goes to the user to which workflow is assigned (by any of the functions: role, profileRole etc.
1.  Explicit - Where you define via actions, preActions, postActions and you define user function as well (role, profileRole)

Notification users are identified by notification functions that include


The following table summarises the different types of notifications and at which level they operate at.

| Notification type        | Explanation           | Level           |
| ------------- |:-------------:|:-------------:|
| Assignment | Triggered when the workflow is assigned to a new user in a step | Process and step |
| Acceptance | Triggered when the workflow advances to a step for which there are multiple users assigned the role for the step | Process |
| Re-assignment | Triggered when the workflow is manually re-assigned to another user | Process |

Acceptance and re-assignment notifications may only be configured at the process level.  Assignment notifications may be configured at either the process or step level.  In practice configuring assignment notifications at the step level gives more flexibility over the messaging and the steps on which they are associated.

# Workflow parameters

The following parameters may be used when configuring notifications.

| Parameter        | Explanation           | Option           |
| ------------- |:-------------:|:-------------:|
| notificationAction | This determines the action that will be taken when the user clicks on the link in the notification.  It may either call a specific URL or open the workflow. | URL (opens a URL you specify), "goto": "profile" (opens the default page for the profile in which the workflow is located), "goto": "processListing" (opens the workflow page for the profile), "goto": "subProcessInstance" (opens the sub process instance for the workflow), "goto": "subProfile" (used in cases where the workflow is at the sub profile level), "goto": "subProfileListing" (used in cases where the workflow is at the sub profile level), "goto": "subProfileSubProcessInstance" (used in cases where the workflow is at the sub profile level) |
| messageType | Notifications may be to inform or to request an action | info or action |
| priority | Specifies the priority of the notification.  Critical notifications are presented on an overlay which blocks the page until an action is taken. | normal, action or critical |
| variables | You may personalise notifications using one or more of the variables. | Please see below for a list of variables |
| recipients | 1. role, 2.profileRole, 3. subProfileRole, 4. userId, 5. currentStepUser/Role. Workflow may either be assigned directly to the user assigned the workflow for a step or to all users with the role associated with the step.  In the latter case replace "Capturer" with the relevant role ID | stepAssignee or role":"Capturer" |

The following variables may be used to personalise the notification messaging.

| Variable        | Explanation           |
| ------------- |:-------------:|
| "#PROFILE_ID#" | Displays the UUID of the profile in which the workflow is located | 
| "#PROFILE_NAME#" | Displays the name of the profile in which the workflow is located | 
| "#COMMUNITY_ID#" | Displays the UUID of the community in which the workflow is located | 
| "#COMMUNITY_NAME#" | Displays the name of the community in which the workflow is located | 
| "#APPLICATION_ID#" | Displays the UUID of the app in which the workflow is located | 
| "#APPLICATION_NAME#" | Displays the name of the app in which the workflow is located | 
| "#CURRENT_USER_ID#" | Displays the UUID of the user to which the notification is being sent | 
| "#CURRENT_USER_NAME#" | Displays the name of the user to which the notification is being sent | 
| "#SUB_PROCESS_ID#" | Displays the UUID of the sub process for the workflow | 
| "#SUB_PROCESS_NAME#" | Displays the name of the sub process for the workflow | 
| "#VALID_DATE#" | Displays the UUID of the user to which the notification is being sent | 
| "#NODE_TITLE#" | Displays the name of the sub profile in which the workflow is located | 
| "#STEP_ID#" | Displays the UUID of the step to which the notification is related | 
| "#STEP_NAME#" | Displays the name of the step to which the notification is related | 
| "#STEP_CREATED_DATE_TIME#" | Displays the date and time on which the step associated with the notification is created | 
| "#NOTIFICATION_DATE_TIME#" | Displays the date and time on which the notification is generated | 
| "#DUE_DATE#" | Displays the date on which the workflow sub process instance is due | 

# Process level notifications

Following are examples of process level notifications.  These are configured at the root level of the workflow process.

## Assignment notification

The following example code is for a process level assignment notification.  This will trigger a notification each time a step in the workflow process is assigned to a user.

```
"assignment": {
                    "message": {
                        "i18n": {
                            "_id": "en",
                            "en": "Hi #CURRENT_USER_NAME#, A new workflow is assigned to you. Please follow below link to move to subprocess"
                        }
                    },
                    "messageType": "action",
                    "notificationAction": {
                        "action": {
                            "goto": "subProcessInstance"
                        },
                        "label": {
                            "i18n": {
                                "_id": "en",
                                "en": "Open subprocess"
                            }
                        }
                    },
                    "priority": "normal",
                    "title": {
                        "i18n": {
                            "_id": "en",
                            "en": "Workflow acceptance #SUB_PROCESS_NAME# Test"
                        }
                    }
                }
```

## Acceptance notifications

The following example code is for a process level acceptance notifications.  This will trigger a notification each time a step in the workflow process is assigned to a role.  All users with that role will receive the notification.  This alerts users that a workflow is waiting for one of them to accept it.  Once one person accepts it, an assignment notification will then be sent (if configured).

```
"assignmentAcceptance": {
                    "message": {
                        "i18n": {
                            "_id": "en",
                            "en": "The workflow to approve outcome #SUB_PROCESS_NAME# is waiting for you or other users with your role to accept.  Please click the link below to open the workflow and accept it."
                        }
                    },
                    "messageType": "action",
                    "notificationAction": {
                        "action": {
                            "goto": "subProcessInstance"
                        },
                        "label": {
                            "i18n": {
                                "_id": "en",
                                "en": "Open outcome"
                            }
                        }
                    },
                    "priority": "normal",
                    "title": {
                        "i18n": {
                            "_id": "en",
                            "en": "Acceptance - Workflow acceptance"
                        }
                    }
                },
```

## Re-assignment notifications

The following example code is for a process level re-assignment notifications.  This will trigger a notification each time a step in the workflow process is manually re-assigned to a role.

```
"reAssignment": {
                    "message": {
                        "i18n": {
                            "_id": "en",
                            "en": "The workflow to approve outcome #SUB_PROCESS_NAME# has been assigned to you."
                        }
                    },
                    "messageType": "action",
                    "notificationAction": {
                        "action": {
                            "goto": "subProcessInstance"
                        },
                        "label": {
                            "i18n": {
                                "_id": "en",
                                "en": "Open outcome"
                            }
                        }
                    },
                    "priority": "normal",
                    "title": {
                        "i18n": {
                            "_id": "en",
                            "en": "Re-assignment - Workflow reassignment"
                        }
                    }
                }
```
# Step level notifications

Following is an example of a step level notification.  These are configured as a pre or post action on the step to which they apply.

## Assignment notification

The following example code is for a step level assignment notification.  This will trigger a notification each time a step in the workflow process is assigned to a user.  The main difference to the process level acceptance notification is that this code also specifies if the workflow is assigned to a user role or the assigned user.

```
{
    "_id": "wfNotificationEmailNew",
    "_seq": 2,
    "description": {
        "i18n": {
            "_id": "uuid",
            "en": "test"
        }
    },
    "method": {
        "notification": {
            "message": {
                "default": {
                    "i18n": {
                        "_id": "en",
                        "en": "The outcome #SUB_PROCESS_NAME# has been assigned to you for review"
                    }
                },
                "rtf": {
                    "markup": {
                        "i18n": {
                            "_id": "en",
                            "en": "The outcome #SUB_PROCESS_NAME# has been assigned to you for review"
                        }
                    }
                },
                "title": {
                    "i18n": {
                        "_id": "en",
                        "en": "Harvest transition - Outcome #SUB_PROCESS_NAME# waiting for review"
                    }
                }
            },
            "messageType": "action",
            "notificationAction": {
                "action": {
                    "goto": "subProcessInstance"
                },
                "label": {
                    "i18n": {
                        "_id": "en",
                        "en": "Open outcome"
                    }
                }
            },
            "notificationType": "workflow",
            "priority": "normal",
            "recipients": {
                "role": "projectmanager"
            }
        }
    }
}
```

